<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cox Cure Rate Model — cox_cure • intsurv</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cox Cure Rate Model — cox_cure" />
<meta property="og:description" content="For right-censored data, fit a regular Cox cure rate model (Kuk and Chen,
1992; Sy and Taylor, 2000) via an EM algorithm.  For right-censored data
with uncertain event status, fit the Cox cure model proposed by Wang et
al. (2019+)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">intsurv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wenjie2wang/intsurv">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cox Cure Rate Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/wenjie2wang/intsurv/blob/master/R/cox_cure.R'><code>R/cox_cure.R</code></a></small>
    <div class="hidden name"><code>cox_cure.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For right-censored data, fit a regular Cox cure rate model (Kuk and Chen,
1992; Sy and Taylor, 2000) via an EM algorithm.  For right-censored data
with uncertain event status, fit the Cox cure model proposed by Wang et
al. (2019+).</p>
    </div>

    <pre class="usage"><span class='fu'>cox_cure</span>(<span class='no'>surv_formula</span>, <span class='no'>cure_formula</span>,
         <span class='no'>time</span>, <span class='no'>event</span>, <span class='no'>data</span>, <span class='no'>subset</span>, <span class='kw'>contrasts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
         <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>firth</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>surv_start</span>, <span class='no'>cure_start</span>,
         <span class='kw'>em_max_iter</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>em_rel_tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
         <span class='kw'>surv_max_iter</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>surv_rel_tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
         <span class='kw'>cure_max_iter</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>cure_rel_tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
         <span class='kw'>tail_completion</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"zero"</span>, <span class='st'>"exp"</span>, <span class='st'>"zero-tau"</span>),
         <span class='kw'>tail_tau</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pmin</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>early_stop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
         <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>cox_cure.fit</span>(<span class='no'>surv_x</span>, <span class='no'>cure_x</span>, <span class='no'>time</span>, <span class='no'>event</span>, <span class='kw'>cure_intercept</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
             <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>firth</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>surv_start</span>, <span class='no'>cure_start</span>,
             <span class='kw'>surv_standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>cure_standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
             <span class='kw'>em_max_iter</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>em_rel_tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
             <span class='kw'>surv_max_iter</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>surv_rel_tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
             <span class='kw'>cure_max_iter</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>cure_rel_tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>,
             <span class='kw'>tail_completion</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"zero"</span>, <span class='st'>"exp"</span>, <span class='st'>"zero-tau"</span>),
             <span class='kw'>tail_tau</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pmin</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>early_stop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
             <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>surv_formula</th>
      <td><p>A formula object starting with <code>~</code> for the model
formula in survival model part.  For Cox model, no intercept term is
included even if an intercept is specified or implied in the model
formula.  A model formula with an intercept term only is not allowed.</p></td>
    </tr>
    <tr>
      <th>cure_formula</th>
      <td><p>A formula object starting with <code>~</code> for the model
formula in cure rate model part.  For logistic model, an intercept term
is included by default and can be excluded by adding <code>+ 0</code> or
<code>- 1</code> to the model formula.</p></td>
    </tr>
    <tr>
      <th>time</th>
      <td><p>A numeric vector for the observed survival times.</p></td>
    </tr>
    <tr>
      <th>event</th>
      <td><p>A numeric vector for the event indicators.  <code>NA</code>'s are
allowed and represent uncertain event status.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>An optional data frame, list, or environment that contains the
covariates and response variables (<code>time</code> and <code>event</code>),
included in the model. If they are not found in data, the variables are
taken from the environment of the specified formula, usually the
environment from which this function is called.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>An optional logical vector specifying a subset of observations
to be used in the fitting process.</p></td>
    </tr>
    <tr>
      <th>contrasts</th>
      <td><p>An optional list, whose entries are values (numeric
matrices or character strings naming functions) to be used as
replacement values for the contrasts replacement function and whose
names are the names of columns of data containing factors.  See
<code>contrasts.arg</code> of <code><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix.default</a></code> for
details.</p></td>
    </tr>
    <tr>
      <th>bootstrap</th>
      <td><p>An integer representing the number of bootstrap samples for
estimating standard errors of the coefficient estimates.  The bootstrap
procedure will not run with <code>bootstrap = 0</code> by default.  If
<code>bootstrap &gt; 0</code>, the specified number of bootstrap samples will be
used in estimating standard errors.</p></td>
    </tr>
    <tr>
      <th>firth</th>
      <td><p>A logical value indicating whether to use Firth's
bias-reduction method (Firth, 1993) in the logistic model component.
The default value is <code>FALSE</code> for fitting a regular logistic model.
Notice that this argument is experimental and only available for regular
Cox cure rate model currently.</p></td>
    </tr>
    <tr>
      <th>surv_start</th>
      <td><p>An optional numeric vector representing the starting
values for the Cox model component.  If not specified, the starting
values will be obtained from fitting a regular Cox model to events only.</p></td>
    </tr>
    <tr>
      <th>cure_start</th>
      <td><p>An optional numeric vector representing the starting
values for the logistic model component.  If not specified, the starting
values will be obtained from fitting a regular logistic model to the
non-missing event indicators.</p></td>
    </tr>
    <tr>
      <th>em_max_iter</th>
      <td><p>A positive integer specifying the maximum iteration
number of the EM algorithm.  The default value is <code>200</code>.</p></td>
    </tr>
    <tr>
      <th>em_rel_tol</th>
      <td><p>A positive number specifying the tolerance that determines
the convergence of the EM algorithm in terms of the convergence of the
covariate coefficient estimates.  The tolerance is compared with the
relative change between estimates from two consecutive iterations, which
is measured by ratio of the L1-norm of their difference to the sum of
their L1-norm.  The default value is <code>1e-5</code>.</p></td>
    </tr>
    <tr>
      <th>surv_max_iter</th>
      <td><p>A positive integer specifying the maximum iteration
number of the M-step routine related to the survival model component.
The default value is <code>200</code>.</p></td>
    </tr>
    <tr>
      <th>surv_rel_tol</th>
      <td><p>A positive number specifying the tolerance that
determines the convergence of the M-step related to the survival model
component in terms of the convergence of the covariate coefficient
estimates.  The tolerance is compared with the relative change between
estimates from two consecutive iterations, which is measured by ratio of
the L1-norm of their difference to the sum of their L1-norm.  The
default value is <code>1e-5</code>.</p></td>
    </tr>
    <tr>
      <th>cure_max_iter</th>
      <td><p>A positive integer specifying the maximum iteration
number of the M-step routine related to the cure rate model component.
The default value is <code>200</code>.</p></td>
    </tr>
    <tr>
      <th>cure_rel_tol</th>
      <td><p>A positive number specifying the tolerance that
determines the convergence of the M-step related to the cure rate model
component in terms of the convergence of the covariate coefficient
estimates.  The tolerance is compared with the relative change between
estimates from two consecutive iterations, which is measured by ratio of
the L1-norm of their difference to the sum of their L1-norm.  The
default value is <code>1e-5</code>.</p></td>
    </tr>
    <tr>
      <th>tail_completion</th>
      <td><p>A character string specifying the tail completion
method for conditional survival function.  The available methods are
<code>"zero"</code> for zero-tail completion after the largest event times (Sy
and Taylor, 2000), <code>"exp"</code> for exponential-tail completion (Peng,
2003), and <code>"zero-tau"</code> for zero-tail completion after a specified
<code>tail_tau</code>.  The default method is the zero-tail completion
proposed by Sy and Taylor (2000).</p></td>
    </tr>
    <tr>
      <th>tail_tau</th>
      <td><p>A numeric number specifying the time of zero-tail
completion.  It will be used only if <code>tail_completion =
"zero-tau"</code>.  A reasonable choice must be a time point between the
largest event time and the largest survival time.</p></td>
    </tr>
    <tr>
      <th>pmin</th>
      <td><p>A numeric number specifying the minimum value of probabilities
for sake of numerical stability.  The default value is <code>1e-5</code>.</p></td>
    </tr>
    <tr>
      <th>early_stop</th>
      <td><p>A logical value specifying whether to stop the iteration
once the negative log-likelihood unexpectedly increases, which may
suggest convergence on likelihood, or indicate numerical issues or
implementation bugs.  The default value is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical value.  If <code>TRUE</code>, a verbose information will
be given along iterations for tracing the convergence.  The default
value is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments for future usage.  A warning will be thrown if
any invalid argument is specified.</p></td>
    </tr>
    <tr>
      <th>surv_x</th>
      <td><p>A numeric matrix for the design matrix of the survival model
component.</p></td>
    </tr>
    <tr>
      <th>cure_x</th>
      <td><p>A numeric matrix for the design matrix of the cure rate model
component.  The design matrix should exclude an intercept term unless we
want to fit a model only including the intercept term.  In that case, we
need further set <code>cure_intercept = FALSE</code> to not standardize the
intercept term.</p></td>
    </tr>
    <tr>
      <th>cure_intercept</th>
      <td><p>A logical value specifying whether to add an intercept
term to the cure rate model component.  If <code>TRUE</code> by default, an
intercept term is included.</p></td>
    </tr>
    <tr>
      <th>surv_standardize</th>
      <td><p>A logical value specifying whether to standardize
the covariates for the survival model part.  If <code>FALSE</code>, the
covariates will be standardized internally to have mean zero and
standard deviation one.</p></td>
    </tr>
    <tr>
      <th>cure_standardize</th>
      <td><p>A logical value specifying whether to standardize
the covariates for the cure rate model part.  If <code>TRUE</code> (by
default), the covariates will be standardized internally to have mean
zero and standard deviation one.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>cox_cure</code> object for regular Cox cure rate model or
<code>cox_cure_uncer</code> object for Cox cure rate model with uncertain events.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Firth, D. (1993). Bias reduction of maximum likelihood
estimates. <em>Biometrika</em>, 80(1), 27--38.</p>
<p>Kuk, A. Y. C., &amp; Chen, C. (1992). A mixture model combining logistic
regression with proportional hazards regression. <em>Biometrika</em>, 79(3),
531--541.</p>
<p>Peng, Y. (2003). Estimating baseline distribution in proportional hazards
cure models. <em>Computational Statistics &amp; Data Analysis</em>, 42(1-2),
187--201.</p>
<p>Sy, J. P., &amp; Taylor, J. M. (2000). Estimation in a Cox proportional hazards
cure model. <em>Biometrics</em>, 56(1), 227--236.</p>
<p>Wang, W., Chen, K., Luo, C., &amp; Yan, J. (2019+). Cox Cure Model with
Uncertain Event Status with application to a Suicide Risk
Study. <em>Working in Progress</em>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cox_cure_net.html'>cox_cure_net</a></code> for regularized Cox cure rate model with
elastic-net penalty.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>intsurv</span>)

<span class='co'>### regular Cox cure rate model ======================================</span>
<span class='co'>## 1. simulate right-censored data with a cure fraction</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>n_obs</span> <span class='kw'>&lt;-</span> <span class='fl'>2e2</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>5</span>
<span class='no'>x_mat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n_obs</span> * <span class='no'>p</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>n_obs</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>x_mat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"x"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='no'>p</span>))
<span class='no'>cure_beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.5</span>, <span class='no'>p</span>)
<span class='no'>b0</span> <span class='kw'>&lt;-</span> - <span class='fl'>1</span>
<span class='no'>expit</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>binomial</a></span>()$<span class='no'>linkinv</span>
<span class='no'>ncure_prob</span> <span class='kw'>&lt;-</span> <span class='fu'>expit</span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>b0</span> + <span class='no'>x_mat</span> <span class='kw'>%*%</span> <span class='no'>cure_beta</span>))
<span class='no'>is_cure</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> - <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='no'>n_obs</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>ncure_prob</span>)
<span class='no'>surv_beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.5</span>, <span class='no'>p</span>)
<span class='no'>risk_score</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>x_mat</span> <span class='kw'>%*%</span> <span class='no'>surv_beta</span>)
<span class='no'>event_time</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Exponential.html'>rexp</a></span>(<span class='no'>n_obs</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>x_mat</span> <span class='kw'>%*%</span> <span class='no'>surv_beta</span>)))
<span class='no'>censor_time</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='no'>event</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>event_time</span> <span class='kw'>&lt;</span> <span class='no'>censor_time</span> <span class='kw'>&amp;</span> ! <span class='no'>is_cure</span>, <span class='fl'>1</span>, <span class='fl'>0</span>)
<span class='no'>obs_time</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>event</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>, <span class='no'>event_time</span>, <span class='no'>censor_time</span>)

<span class='co'>## model-fitting from given design matrices</span>
<span class='no'>fit1</span> <span class='kw'>&lt;-</span> <span class='fu'>cox_cure.fit</span>(<span class='no'>x_mat</span>, <span class='no'>x_mat</span>, <span class='no'>obs_time</span>, <span class='no'>event</span>, <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>30</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit1</span>)</div><div class='output co'>#&gt; Call:
#&gt; cox_cure.fit(surv_x = x_mat, cure_x = x_mat, time = obs_time, 
#&gt;     event = event, bootstrap = 30)
#&gt; 
#&gt; Coefficient estimates from the survival part:
#&gt; 
#&gt;        coef exp(coef) se(coef)      z  Pr(&gt;|z|)    
#&gt; x1 0.424787  1.529264 0.148820 2.8544  0.004312 ** 
#&gt; x2 0.415574  1.515241 0.251128 1.6548  0.097959 .  
#&gt; x3 0.312479  1.366809 0.215197 1.4521  0.146484    
#&gt; x4 0.656209  1.927471 0.107090 6.1276 8.919e-10 ***
#&gt; x5 0.536194  1.709488 0.093791 5.7169 1.085e-08 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Coefficient estimates from the cure rate part:
#&gt; 
#&gt;                 coef exp(coef) se(coef)       z  Pr(&gt;|z|)    
#&gt; (Intercept) -0.82103   0.43998  0.11138 -7.3716 1.686e-13 ***
#&gt; x1           0.27945   1.32241  0.15172  1.8419  0.065486 .  
#&gt; x2           0.47637   1.61022  0.20779  2.2925  0.021876 *  
#&gt; x3           0.44615   1.56228  0.19981  2.2329  0.025558 *  
#&gt; x4           0.67783   1.96960  0.21637  3.1327  0.001732 ** 
#&gt; x5           0.57693   1.78057  0.20864  2.7652  0.005688 ** 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Number of observations: 200
#&gt; Number of events: 70
#&gt; Weighted concordance index: 83.77%
#&gt; Observed data log-likelihood: -390.904</div><div class='input'>
<span class='co'>## coefficient estimates from both model parts</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>fit1</span>)</div><div class='output co'>#&gt; $surv
#&gt;        x1        x2        x3        x4        x5 
#&gt; 0.4247867 0.4155744 0.3124786 0.6562086 0.5361937 
#&gt; 
#&gt; $cure
#&gt; (Intercept)          x1          x2          x3          x4          x5 
#&gt;  -0.8210297   0.2794521   0.4763700   0.4461459   0.6778322   0.5769342 
#&gt; </div><div class='input'>
<span class='co'>## or a particular part</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>fit1</span>, <span class='st'>"surv"</span>)</div><div class='output co'>#&gt;        x1        x2        x3        x4        x5 
#&gt; 0.4247867 0.4155744 0.3124786 0.6562086 0.5361937 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>fit1</span>, <span class='st'>"cure"</span>)</div><div class='output co'>#&gt; (Intercept)          x1          x2          x3          x4          x5 
#&gt;  -0.8210297   0.2794521   0.4763700   0.4461459   0.6778322   0.5769342 </div><div class='input'>
<span class='co'>## compute weighted concordance index (C-index)</span>
<span class='fu'><a href='cIndex.html'>cIndex</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>obs_time</span>, <span class='kw'>event</span> <span class='kw'>=</span> <span class='no'>event</span>,
       <span class='kw'>risk_score</span> <span class='kw'>=</span> <span class='no'>fit1</span>$<span class='no'>fitted</span>$<span class='no'>surv_xBeta</span>,
       <span class='kw'>weight</span> <span class='kw'>=</span> <span class='no'>fit1</span>$<span class='no'>fitted</span>$<span class='no'>susceptible_prob</span>)</div><div class='output co'>#&gt;        index   concordant   comparable    tied_risk 
#&gt;    0.8376682 4769.5956376 5693.8958945    0.0000000 </div><div class='input'>
<span class='co'>## or directly extract C-index from the object</span>
<span class='no'>fit1</span>$<span class='no'>model</span>$<span class='no'>c_index</span></div><div class='output co'>#&gt; [1] 0.8376682</div><div class='input'>
<span class='co'>## 2. create a toy dataset</span>
<span class='no'>toy_dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>obs_time</span>, <span class='kw'>status</span> <span class='kw'>=</span> <span class='no'>event</span>)
<span class='no'>toy_dat</span>$<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>x_mat</span>[, <span class='fl'>1L</span>]), <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>Inf</span>),
                     <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>))
<span class='no'>toy_dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>toy_dat</span>, <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='no'>x_mat</span>[, - <span class='fl'>1L</span>, <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>]))

<span class='co'>## model-fitting from given model formula</span>
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>cox_cure</span>(~ <span class='no'>x2</span> + <span class='no'>x3</span> + <span class='no'>x4</span> + <span class='no'>group</span>, ~ <span class='no'>x2</span> + <span class='no'>x3</span> + <span class='no'>group</span>,
                 <span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>time</span>, <span class='kw'>event</span> <span class='kw'>=</span> <span class='no'>status</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>toy_dat</span>,
                 <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>group</span> <span class='kw'>!=</span> <span class='st'>"D"</span>, <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>30</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; Call:
#&gt; cox_cure(surv_formula = ~x2 + x3 + x4 + group, cure_formula = ~x2 + 
#&gt;     x3 + group, time = time, event = status, data = toy_dat, 
#&gt;     subset = group != "D", bootstrap = 30)
#&gt; 
#&gt; Coefficient estimates from the survival part:
#&gt; 
#&gt;             coef exp(coef)  se(coef)      z  Pr(&gt;|z|)    
#&gt; x2     0.3621462 1.4364089 0.0922064 3.9276 8.581e-05 ***
#&gt; x3     0.2697801 1.3096765 0.1303953 2.0689   0.03855 *  
#&gt; x4     0.6799737 1.9738259 0.1516270 4.4845 7.308e-06 ***
#&gt; groupB 0.1084115 1.1145063 0.2885040 0.3758   0.70709    
#&gt; groupC 0.0075088 1.0075371 0.3195018 0.0235   0.98125    
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Coefficient estimates from the cure rate part:
#&gt; 
#&gt;                 coef exp(coef) se(coef)       z Pr(&gt;|z|)   
#&gt; (Intercept) -0.78654   0.45542  0.28610 -2.7491 0.005975 **
#&gt; x2           0.51825   1.67909  0.21957  2.3603 0.018259 * 
#&gt; x3           0.39331   1.48188  0.15029  2.6171 0.008869 **
#&gt; groupB       0.53074   1.70019  0.36584  1.4508 0.146848   
#&gt; groupC      -0.24558   0.78225  0.56860 -0.4319 0.665815   
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Number of observations: 199
#&gt; Number of events: 69
#&gt; Weighted concordance index: 75.89%
#&gt; Observed data log-likelihood: -404.311</div><div class='input'>
<span class='co'>## get BIC's</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span>(<span class='no'>fit1</span>)</div><div class='output co'>#&gt; [1] 840.0902</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; [1] 861.5559</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span>(<span class='no'>fit1</span>, <span class='no'>fit2</span>)</div><div class='output co'>#&gt;      df      BIC
#&gt; fit1 11 840.0902
#&gt; fit2 10 861.5559</div><div class='input'>

<span class='co'>### Cox cure rate model with uncertain event status ==================</span>
<span class='co'>## simulate sample data</span>
<span class='no'>sim_dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simData4cure.html'>simData4cure</a></span>(<span class='kw'>nSubject</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>max_censor</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                        <span class='kw'>survMat</span> <span class='kw'>=</span> <span class='no'>x_mat</span>, <span class='kw'>cureMat</span> <span class='kw'>=</span> <span class='no'>x_mat</span>, <span class='kw'>b0</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>sim_dat</span>$<span class='no'>case</span>)</div><div class='output co'>#&gt; 
#&gt;  1 2b 2a 3b 3a 3c 
#&gt; 43 67 75  7  4  4 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>sim_dat</span>$<span class='no'>obs_event</span>, <span class='kw'>useNA</span> <span class='kw'>=</span> <span class='st'>"ifany"</span>)</div><div class='output co'>#&gt; 
#&gt;    0    1 &lt;NA&gt; 
#&gt;  142   43   15 </div><div class='input'>
<span class='co'>## use formula</span>
<span class='no'>fit3</span> <span class='kw'>&lt;-</span> <span class='fu'>cox_cure</span>(~ <span class='no'>x1</span> + <span class='no'>x2</span> + <span class='no'>x3</span>, ~ <span class='no'>z1</span> + <span class='no'>z2</span> + <span class='no'>z3</span>,
                 <span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>obs_time</span>, <span class='kw'>event</span> <span class='kw'>=</span> <span class='no'>obs_event</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sim_dat</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit3</span>)</div><div class='output co'>#&gt; Call:
#&gt; cox_cure(surv_formula = ~x1 + x2 + x3, cure_formula = ~z1 + z2 + 
#&gt;     z3, time = obs_time, event = obs_event, data = sim_dat)
#&gt; 
#&gt; Coefficient estimates from the survival part:
#&gt; 
#&gt;        coef exp(coef) se(coef)  z Pr(&gt;|z|)
#&gt; x1 0.032763  1.033306       NA NA       NA
#&gt; x2 1.003005  2.726462       NA NA       NA
#&gt; x3 1.083061  2.953707       NA NA       NA
#&gt; 
#&gt; Coefficient estimates from the cure rate part:
#&gt; 
#&gt;                coef exp(coef) se(coef)  z Pr(&gt;|z|)
#&gt; (Intercept) 0.91883   2.50636       NA NA       NA
#&gt; z1          1.10733   3.02628       NA NA       NA
#&gt; z2          0.37420   1.45383       NA NA       NA
#&gt; z3          0.14176   1.15231       NA NA       NA
#&gt; 
#&gt; Number of observations: 200
#&gt; Number of events: 43
#&gt; Weighted concordance index: 78.88%
#&gt; Observed data log-likelihood: -1037.769</div><div class='input'>
<span class='co'>## use design matrix</span>
<span class='no'>fit4</span> <span class='kw'>&lt;-</span> <span class='fu'>cox_cure.fit</span>(<span class='no'>x_mat</span>, <span class='no'>x_mat</span>, <span class='kw'>time</span> <span class='kw'>=</span> <span class='no'>sim_dat</span>$<span class='no'>obs_time</span>,
                     <span class='kw'>event</span> <span class='kw'>=</span> <span class='no'>sim_dat</span>$<span class='no'>obs_event</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit4</span>)</div><div class='output co'>#&gt; Call:
#&gt; cox_cure.fit(surv_x = x_mat, cure_x = x_mat, time = sim_dat$obs_time, 
#&gt;     event = sim_dat$obs_event)
#&gt; 
#&gt; Coefficient estimates from the survival part:
#&gt; 
#&gt;       coef exp(coef) se(coef)  z Pr(&gt;|z|)
#&gt; x1 0.56189   1.75399       NA NA       NA
#&gt; x2 0.85788   2.35816       NA NA       NA
#&gt; x3 0.94811   2.58084       NA NA       NA
#&gt; x4 0.94266   2.56679       NA NA       NA
#&gt; x5 0.96433   2.62304       NA NA       NA
#&gt; 
#&gt; Coefficient estimates from the cure rate part:
#&gt; 
#&gt;                   coef  exp(coef) se(coef)  z Pr(&gt;|z|)
#&gt; (Intercept) 1.0022e+01 2.2524e+04       NA NA       NA
#&gt; x1          1.3702e+01 8.9290e+05       NA NA       NA
#&gt; x2          1.2635e+01 3.0702e+05       NA NA       NA
#&gt; x3          5.6389e+00 2.8116e+02       NA NA       NA
#&gt; x4          5.6894e+00 2.9573e+02       NA NA       NA
#&gt; x5          1.4526e+00 4.2743e+00       NA NA       NA
#&gt; 
#&gt; Number of observations: 200
#&gt; Number of events: 43
#&gt; Weighted concordance index: 86.94%
#&gt; Observed data log-likelihood: -1006.335</div><div class='input'>
<span class='co'>## get BIC's</span>
<span class='fu'><a href='https://rdrr.io/r/stats/AIC.html'>BIC</a></span>(<span class='no'>fit3</span>, <span class='no'>fit4</span>)</div><div class='output co'>#&gt;      df      BIC
#&gt; fit3  7 2112.626
#&gt; fit4 11 2070.952</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Wenjie Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


